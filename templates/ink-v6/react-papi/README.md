# React PAPI Template

A modern **React + TypeScript + Vite** template for building Polkadot decentralized applications (dApps) using the PAPI SDK.

## ðŸš€ Features

- **React** with TypeScript support
- **Vite** for fast development and building
- **PAPI SDK** integration for Polkadot blockchain interaction
- **Smart Contract Support** - Query and interact with ink! smart contracts
- **TailwindCSS + DaisyUI** for beautiful UI components
- **Wallet Connection** support via Talisman Connect
- **XState Store** for state management
- **Iconify** icons integration
- Pre-configured for **Polkadot testnet**

## ðŸ”— SDK Information

This template uses **PAPI (Polkadot API)** - a modern, type-safe SDK for interacting with Polkadot-based blockchains.

ðŸ“š **PAPI Documentation**: https://papi.how/

### Configuration Files:
- **`src/utils/sdk.ts`** - Configures which chains to connect to and manages chain endpoints. You can modify supported networks and RPC providers here.
- **`src/utils/contract-config.ts`** - Contract configuration and metadata setup.
- **`src/utils/formatters.ts`** - Utility functions for formatting data.

## ðŸŒ Supported Chains

The template comes pre-configured for:
- **Passet Hub** - Polkadot Asset Hub Testnet

## ðŸ› ï¸ Getting Started

```bash
# Install dependencies
npm install

# Start development server
npm run dev

# Build for production
npm run build

# Preview production build
npm run preview
```

## ðŸ“œ Smart Contract Development

This template includes a sample flipper contract in the `contract/` directory to help you get started.

### Building the Contract

```bash
# Build the smart contract
npm run build:contract
```

This will compile your ink! smart contract and generate the contract metadata at `contract/target/ink/flipper.json`.

### Deploying the Contract

```bash
# Deploy contract to Passet Hub testnet
npm run deploy:contract
```

This will deploy your contract using `pop` CLI with wallet integration.

### Generating Types

```bash
# Generate TypeScript descriptors from contract metadata
npm run generate:contract

# Generate chain descriptors from RPC endpoint
npm run generate:chain

# Generate all descriptors (contracts + chains)
npx papi
```

The `generate:contract` command adds your contract metadata to PAPI and regenerates type-safe descriptors in `src/descriptors/`.

## ðŸ“ Project Structure

```
contract/              # Sample ink! smart contract
â”œâ”€â”€ Cargo.toml
â”œâ”€â”€ lib.rs
â””â”€â”€ target/ink/        # Built contract artifacts (generated after build)
    â”œâ”€â”€ flipper.json   # Contract metadata
    â””â”€â”€ flipper.contract
src/
â”œâ”€â”€ components/        # React components
â”‚   â”œâ”€â”€ AccountCard.tsx
â”‚   â”œâ”€â”€ Balance.tsx
â”‚   â”œâ”€â”€ Connect.tsx
â”‚   â”œâ”€â”€ ContractData.tsx     # Smart contract query display
â”‚   â”œâ”€â”€ Footer.tsx
â”‚   â”œâ”€â”€ Header.tsx
â”‚   â””â”€â”€ SignTransaction.tsx
â”œâ”€â”€ hooks/             # Custom React hooks
â”‚   â”œâ”€â”€ useBalance.ts
â”‚   â”œâ”€â”€ useConnect.ts
â”‚   â”œâ”€â”€ useContractQuery.ts  # Smart contract query logic
â”‚   â”œâ”€â”€ useContractTransaction.ts
â”‚   â”œâ”€â”€ useCurrentBlock.ts
â”‚   â””â”€â”€ useLocalStorage.ts
â”œâ”€â”€ descriptors/       # Chain & contract descriptors (auto-generated by PAPI)
â”œâ”€â”€ utils/             # Utility functions and SDK setup
â”œâ”€â”€ style.css          # Global styles
â””â”€â”€ App.tsx            # Main application component
```

## ðŸ”— Smart Contract Integration

This template includes support for querying and interacting with ink! smart contracts using PAPI's ink SDK.

### Querying Contract Data

The template includes a `ContractData.tsx` component that demonstrates how to query smart contract state. See the implementation in:

- **`src/hooks/useContractQuery.ts`** - Contains the contract query logic
- **`src/components/ContractData.tsx`** - Displays the contract data in the UI

Example usage:

```typescript
import { createInkSdk } from '@polkadot-api/sdk-ink'
import { contracts } from '~/descriptors'

// Create ink SDK instance
const inkSdk = createInkSdk(polkadotClient)

// Get contract instance
const contract = inkSdk.getContract(contracts.flipper, CONTRACT_ADDRESS)

// Query contract state
const result = await contract.query('get', {
  origin: userAddress,
})

if (result.success) {
  const value = result.value.response // boolean value from flipper contract
}
```

### Executing Contract Transactions

The template also includes a `SignTransaction.tsx` component for executing contract transactions:

- **`src/hooks/useContractTransaction.ts`** - Contains the contract transaction logic
- **`src/components/SignTransaction.tsx`** - UI for sending transactions

Example usage:

```typescript
// Execute contract transaction
const tx = contract.send('flip', {
  origin: userAddress,
})

// Sign and send transaction
tx.signSubmitAndWatch(polkadotSigner).subscribe({
  next: (event) => {
    if (event.type === 'finalized') {
      console.log('Transaction finalized!')
    }
  },
  error: (err) => {
    console.error('Transaction error:', err)
  },
})
```

ðŸ“– For more details on smart contract integration, see the [PAPI Ink SDK documentation](https://papi.how/ink).

## ðŸ”§ Adding Custom Networks

### Step 1: Generate Chain Descriptors

PAPI requires type descriptors for each chain. Generate them using the PAPI CLI:

```bash
# Add a new chain using a WebSocket endpoint
npx papi add your_chain -w wss://your-rpc-endpoint.io

# Or use a well-known chain name
npx papi add kusama -n ksmcc3

# Generate descriptors (automatically runs on postinstall)
npx papi
```

This creates type-safe descriptors in `@polkadot-api/descriptors` that you can import.

### Step 2: Configure Your Chain

Edit `src/utils/sdk.ts` to add your chain configuration:

```typescript
import { yourChain } from '@polkadot-api/descriptors'

const CONFIG = {
  // ... existing chains
  your_chain: {
    descriptor: yourChain,
    providers: ['wss://your-rpc-endpoint.io'],
  },
}
```

You can add multiple RPC endpoints for fallback support:

```typescript
const CONFIG = {
  dot: {
    descriptor: polkadot,
    providers: [
      'wss://rpc.polkadot.io',
      'wss://polkadot-rpc.dwellir.com'
    ],
  },
}
```

ðŸ“– For more details, see the [PAPI Codegen documentation](https://papi.how/codegen).

## ðŸ“š Learn More

- [React Documentation](https://react.dev/)
- [PAPI Documentation](https://papi.how/)
- [Polkadot Developer Portal](https://wiki.polkadot.network/)
